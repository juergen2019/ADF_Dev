{
	"name": "gcread",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "GC_Data",
						"type": "DatasetReference"
					},
					"name": "GCData"
				},
				{
					"dataset": {
						"referenceName": "CTLData",
						"type": "DatasetReference"
					},
					"name": "CTL"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "CTL",
						"type": "DatasetReference"
					},
					"name": "CTLTable"
				},
				{
					"dataset": {
						"referenceName": "Parquet1",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "Select1"
				},
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "DerivedColumn2"
				},
				{
					"name": "AlterRow1"
				}
			],
			"script": "\n\nsource(output(\n\t\tdate as string,\n\t\t{ time} as string,\n\t\t{ filename} as string,\n\t\t{ axPower} as string,\n\t\t{ aPower_Relative_Intensity} as string,\n\t\t{ aBikeScore} as string,\n\t\t{ Skiba_aVI} as string,\n\t\t{ aPower_Response_Index} as string,\n\t\t{ aNP} as string,\n\t\t{ aIF} as string,\n\t\t{ aTSS} as string,\n\t\t{ aVI} as string,\n\t\t{ aPower_Efficiency_Factor} as string,\n\t\t{ aTSS_per_hour} as string,\n\t\t{ Aerobic_Decoupling} as string,\n\t\t{ Activities} as string,\n\t\t{ To_Exhaustion} as string,\n\t\t{ Duration} as string,\n\t\t{ Time_Moving} as string,\n\t\t{ Time_Carrying_(Est)} as string,\n\t\t{ Elevation_Gain_Carrying_(Est)} as string,\n\t\t{ Distance} as string,\n\t\t{ Climb_Rating} as string,\n\t\t{ Athlete_Weight} as string,\n\t\t{ Athlete_Bodyfat} as string,\n\t\t{ Athlete_Lean_Weight} as string,\n\t\t{ Athlete_Bodyfat_Percent} as string,\n\t\t{ Elevation_Gain} as string,\n\t\t{ Elevation_Loss} as string,\n\t\t{ Work} as string,\n\t\t{ Average_Speed} as string,\n\t\t{ Average_Power} as string,\n\t\t{ Average_SmO2} as string,\n\t\t{ Average_tHb} as string,\n\t\t{ Average_aPower} as string,\n\t\t{ Nonzero_Average_Power} as string,\n\t\t{ Average_Heart_Rate} as string,\n\t\t{ Average_Core_Temperature} as string,\n\t\t{ Heartbeats} as string,\n\t\t{ HrPw_Ratio} as string,\n\t\t{ Workbeat_stress} as string,\n\t\t{ Watts:RPE_Ratio} as string,\n\t\t{ Power_Percent_of_Max} as string,\n\t\t{ HrNp_Ratio} as string,\n\t\t{ Average_Cadence} as string,\n\t\t{ Average_Temp} as string,\n\t\t{ Max_Power} as string,\n\t\t{ Max_SmO2} as string,\n\t\t{ Max_tHb} as string,\n\t\t{ Min_SmO2} as string,\n\t\t{ Min_tHb} as string,\n\t\t{ Max_Heartrate} as string,\n\t\t{ Min_Heartrate} as string,\n\t\t{ Max_Core_Temperature} as string,\n\t\t{ Max_Speed} as string,\n\t\t{ Max_Cadence} as string,\n\t\t{ Max_Temp} as string,\n\t\t{ Min_Temp} as string,\n\t\t{ 95%_Heartrate} as string,\n\t\t{ VAM} as string,\n\t\t{ Effect_of_Altitude} as string,\n\t\t{ Gradient} as string,\n\t\t{ Average_Power_Variance} as string,\n\t\t{ Max_Power_Variance} as string,\n\t\t{ Average_Left_Torque_Effectiveness} as string,\n\t\t{ Average_Right_Torque_Effectiveness} as string,\n\t\t{ Average_Left_Pedal_Smoothness} as string,\n\t\t{ Average_Right_Pedal_Smoothness} as string,\n\t\t{ Average_Left_Pedal_Center_Offset} as string,\n\t\t{ Average_Right_Pedal_Center_Offset} as string,\n\t\t{ Average_Left_Power_Phase_Start} as string,\n\t\t{ Average_Right_Power_Phase_Start} as string,\n\t\t{ Average_Left_Power_Phase_End} as string,\n\t\t{ Average_Right_Power_Phase_End} as string,\n\t\t{ Average_Left_Peak_Power_Phase_Start} as string,\n\t\t{ Average_Right_Peak_Power_Phase_Start} as string,\n\t\t{ Average_Left_Peak_Power_Phase_End} as string,\n\t\t{ Average_Right_Peak_Power_Phase_End} as string,\n\t\t{ Average_Left_Power_Phase_Length} as string,\n\t\t{ Average_Right_Power_Phase_Length} as string,\n\t\t{ Average_Left_Peak_Power_Phase_Length} as string,\n\t\t{ Average_Right_Peak_Power_Phase_Length} as string,\n\t\t{ Calories_(HR)} as string,\n\t\t{ Checksum} as string,\n\t\t{ Aerobic_TISS} as string,\n\t\t{ Anaerobic_TISS} as string,\n\t\t{ Critical_Power} as string,\n\t\t{ xPower} as string,\n\t\t{ Relative_Intensity} as string,\n\t\t{ BikeScore} as string,\n\t\t{ Skiba_VI} as string,\n\t\t{ TISS_Aerobicity} as string,\n\t\t{ Response_Index} as string,\n\t\t{ NP} as string,\n\t\t{ IF} as string,\n\t\t{ TSS} as string,\n\t\t{ VI} as string,\n\t\t{ Efficiency_Factor} as string,\n\t\t{ TSS_per_hour} as string,\n\t\t{ Exhaustion_Best_R} as string,\n\t\t{ Daniels_Points} as string,\n\t\t{ Daniels_EqP} as string,\n\t\t{ LNP} as string,\n\t\t{ RTP} as string,\n\t\t{ xPace} as string,\n\t\t{ IWF} as string,\n\t\t{ GOVSS} as string,\n\t\t{ H1_Time_in_Zone} as string,\n\t\t{ H2_Time_in_Zone} as string,\n\t\t{ H3_Time_in_Zone} as string,\n\t\t{ H4_Time_in_Zone} as string,\n\t\t{ H5_Time_in_Zone} as string,\n\t\t{ H6_Time_in_Zone} as string,\n\t\t{ H7_Time_in_Zone} as string,\n\t\t{ H8_Time_in_Zone} as string,\n\t\t{ H9_Time_in_Zone} as string,\n\t\t{ H10_Time_in_Zone} as string,\n\t\t{ H1_Percent_in_Zone} as string,\n\t\t{ H2_Percent_in_Zone} as string,\n\t\t{ H3_Percent_in_Zone} as string,\n\t\t{ H4_Percent_in_Zone} as string,\n\t\t{ H5_Percent_in_Zone} as string,\n\t\t{ H6_Percent_in_Zone} as string,\n\t\t{ H7_Percent_in_Zone} as string,\n\t\t{ H8_Percent_in_Zone} as string,\n\t\t{ H9_Percent_in_Zone} as string,\n\t\t{ H10_Percent_in_Zone} as string,\n\t\t{ Left/Right_Balance} as string,\n\t\t{ P1_Time_in_Pace_Zone} as string,\n\t\t{ P2_Time_in_Pace_Zone} as string,\n\t\t{ P3_Time_in_Pace_Zone} as string,\n\t\t{ P4_Time_in_Pace_Zone} as string,\n\t\t{ P5_Time_in_Pace_Zone} as string,\n\t\t{ P6_Time_in_Pace_Zone} as string,\n\t\t{ P7_Time_in_Pace_Zone} as string,\n\t\t{ P8_Time_in_Pace_Zone} as string,\n\t\t{ P9_Time_in_Pace_Zone} as string,\n\t\t{ P10_Time_in_Pace_Zone} as string,\n\t\t{ P1_Percent_in_Pace_Zone} as string,\n\t\t{ P2_Percent_in_Pace_Zone} as string,\n\t\t{ P3_Percent_in_Pace_Zone} as string,\n\t\t{ P4_Percent_in_Pace_Zone} as string,\n\t\t{ P5_Percent_in_Pace_Zone} as string,\n\t\t{ P6_Percent_in_Pace_Zone} as string,\n\t\t{ P7_Percent_in_Pace_Zone} as string,\n\t\t{ P8_Percent_in_Pace_Zone} as string,\n\t\t{ P9_Percent_in_Pace_Zone} as string,\n\t\t{ P10_Percent_in_Pace_Zone} as string,\n\t\t{ 10_sec_Peak_Pace} as string,\n\t\t{ 15_sec_Peak_Pace} as string,\n\t\t{ 20_sec_Peak_Pace} as string,\n\t\t{ 30_sec_Peak_Pace} as string,\n\t\t{ 1_min_Peak_Pace} as string,\n\t\t{ 2_min_Peak_Pace} as string,\n\t\t{ 3_min_Peak_Pace} as string,\n\t\t{ 5_min_Peak_Pace} as string,\n\t\t{ 8_min_Peak_Pace} as string,\n\t\t{ 10_min_Peak_Pace} as string,\n\t\t{ 20_min_Peak_Pace} as string,\n\t\t{ 30_min_Peak_Pace} as string,\n\t\t{ 60_min_Peak_Pace} as string,\n\t\t{ 90_min_Peak_Pace} as string,\n\t\t{ 10_sec_Peak_Pace_Swim} as string,\n\t\t{ 15_sec_Peak_Pace_Swim} as string,\n\t\t{ 20_sec_Peak_Pace_Swim} as string,\n\t\t{ 30_sec_Peak_Pace_Swim} as string,\n\t\t{ 1_min_Peak_Pace_Swim} as string,\n\t\t{ 2_min_Peak_Pace_Swim} as string,\n\t\t{ 3_min_Peak_Pace_Swim} as string,\n\t\t{ 5_min_Peak_Pace_Swim} as string,\n\t\t{ 8_min_Peak_Pace_Swim} as string,\n\t\t{ 10_min_Peak_Pace_Swim} as string,\n\t\t{ 20_min_Peak_Pace_Swim} as string,\n\t\t{ 30_min_Peak_Pace_Swim} as string,\n\t\t{ 60_min_Peak_Pace_Swim} as string,\n\t\t{ 90_min_Peak_Pace_Swim} as string,\n\t\t{ Best_50m} as string,\n\t\t{ Best_100m} as string,\n\t\t{ Best_200m} as string,\n\t\t{ Best_400m} as string,\n\t\t{ Best_500m} as string,\n\t\t{ Best_800m} as string,\n\t\t{ Best_1000m} as string,\n\t\t{ Best_1500m} as string,\n\t\t{ Best_2000m} as string,\n\t\t{ Best_3000m} as string,\n\t\t{ Best_4000m} as string,\n\t\t{ Best_5000m} as string,\n\t\t{ Best_10km} as string,\n\t\t{ Best_15km} as string,\n\t\t{ Best_20km} as string,\n\t\t{ Best_Half_Marathon} as string,\n\t\t{ Best_30km} as string,\n\t\t{ Best_40km} as string,\n\t\t{ Best_Marathon} as string,\n\t\t{ MMP_Percentage} as string,\n\t\t{ Power_Zone} as string,\n\t\t{ Fatigue_Index} as string,\n\t\t{ Pacing_Index} as string,\n\t\t{ 1_sec_Peak_Power} as string,\n\t\t{ 5_sec_Peak_Power} as string,\n\t\t{ 10_sec_Peak_Power} as string,\n\t\t{ 15_sec_Peak_Power} as string,\n\t\t{ 20_sec_Peak_Power} as string,\n\t\t{ 30_sec_Peak_Power} as string,\n\t\t{ 1_min_Peak_Power} as string,\n\t\t{ 2_min_Peak_Power} as string,\n\t\t{ 3_min_Peak_Power} as string,\n\t\t{ 5_min_Peak_Power} as string,\n\t\t{ 8_min_Peak_Power} as string,\n\t\t{ 10_min_Peak_Power} as string,\n\t\t{ 20_min_Peak_Power} as string,\n\t\t{ 30_min_Peak_Power} as string,\n\t\t{ 60_min_Peak_Power} as string,\n\t\t{ 90_min_Peak_Power} as string,\n\t\t{ 1_min_Peak_Power_HR} as string,\n\t\t{ 5_min_Peak_Power_HR} as string,\n\t\t{ 10_min_Peak_Power_HR} as string,\n\t\t{ 20_min_Peak_Power_HR} as string,\n\t\t{ 30_min_Peak_Power_HR} as string,\n\t\t{ 60_min_Peak_Power_HR} as string,\n\t\t{ Average_Running_Cadence} as string,\n\t\t{ Max_Running_Cadence} as string,\n\t\t{ Average_Ground_Contact_Time} as string,\n\t\t{ Average_Vertical_Oscillation} as string,\n\t\t{ Pace} as string,\n\t\t{ Efficiency_Index} as string,\n\t\t{ Average_Stride_Length} as string,\n\t\t{ Distance_Swim} as string,\n\t\t{ Pace_Swim} as string,\n\t\t{ Swim_Pace} as string,\n\t\t{ Stroke_Rate} as string,\n\t\t{ Strokes_Per_Length} as string,\n\t\t{ SWolf} as string,\n\t\t{ Swim_Pace_Free} as string,\n\t\t{ Swim_Pace_Back} as string,\n\t\t{ Swim_Pace_Breast} as string,\n\t\t{ Swim_Pace_Fly} as string,\n\t\t{ L1_Sustained_Time} as string,\n\t\t{ L2_Sustained_Time} as string,\n\t\t{ L3_Sustained_Time} as string,\n\t\t{ L4_Sustained_Time} as string,\n\t\t{ L5_Sustained_Time} as string,\n\t\t{ L6_Sustained_Time} as string,\n\t\t{ L7_Sustained_Time} as string,\n\t\t{ L8_Sustained_Time} as string,\n\t\t{ L9_Sustained_Time} as string,\n\t\t{ L10_Sustained_Time} as string,\n\t\t{ xPower_Swim} as string,\n\t\t{ STP} as string,\n\t\t{ xPace_Swim} as string,\n\t\t{ SRI} as string,\n\t\t{ SwimScore} as string,\n\t\t{ TriScore} as string,\n\t\t{ L1_Time_in_Zone} as string,\n\t\t{ L2_Time_in_Zone} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> GCData\nsource(output(\n\t\tDay as string,\n\t\tGoal1 as string,\n\t\tReal2 as string,\n\t\tRides as string,\n\t\tATL as string,\n\t\tCTL as string,\n\t\tTSB as string,\n\t\t{3d roll TSS} as string,\n\t\t{7d roll TSS} as string,\n\t\t{28d roll TSS} as string,\n\t\tGoal10 as string,\n\t\tReal11 as string,\n\t\t{7d roll CTL ramp} as string,\n\t\t{Total Weekly Hours} as string,\n\t\t{Total Cumulative Hours} as string,\n\t\t{CTL Ramp Rate} as string,\n\t\t{Total Weekly TSS} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> CTL\nGCData select(mapColumn(\n\t\tDate = date,\n\t\tTime = { time},\n\t\tDistance = { Distance},\n\t\tDuration = { Duration},\n\t\tMovingTime = { Time_Moving},\n\t\taxPower = { axPower},\n\t\tAveragePower = { Average_Power},\n\t\tAverageaPower = { Average_aPower},\n\t\tNonzeroAveragePower = { Nonzero_Average_Power},\n\t\tWork = { Work},\n\t\tIF = { IF},\n\t\taIF = { aIF},\n\t\tNP = { NP},\n\t\taNP = { aNP},\n\t\taTSS = { aTSS},\n\t\tTSS = { TSS},\n\t\tTSSperHour = { TSS_per_hour},\n\t\tAverageHeartRate = { Average_Heart_Rate},\n\t\tMinHeartRate = { Min_Heartrate},\n\t\tMaxHeartRate = { Max_Heartrate},\n\t\tElevationGain = { Elevation_Gain},\n\t\tAverageCadence = { Average_Cadence},\n\t\tAverageSpeed = { Average_Speed},\n\t\tHRPWRAtio = { HrPw_Ratio},\n\t\tMaxPower = { Max_Power},\n\t\t{20MinPower} = { 20_min_Peak_Power},\n\t\t{10MinPower} = { 10_min_Peak_Power},\n\t\t{60MinPower} = { 60_min_Peak_Power}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 derive(Date = toDate(Date, 'MM/dd/yyyy'),\n\t\tDistance = toDecimal(Distance)) ~> DerivedColumn1\nCTL derive(Day = toDate(Day,'MM/dd/yyyy'),\n\t\tRides = toInteger(Rides),\n\t\tReal2 = toDouble(Real2),\n\t\tATL = toDouble(ATL),\n\t\tCTL = toDouble(CTL),\n\t\tTSB = toDouble(TSB)) ~> DerivedColumn2\nDerivedColumn2 alterRow(insertIf(true())) ~> AlterRow1\nAlterRow1 sink(input(\n\t\tDay as timestamp,\n\t\tRides as integer,\n\t\tTSS as decimal(18,0),\n\t\tATL as decimal(18,0),\n\t\tCTL as decimal(18,0),\n\t\tTSB as decimal(18,0)\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:true,\n\tupsertable:false,\n\tformat: 'table',\n\tkeys:['Day'],\n\tmapColumn(\n\t\tDay,\n\t\tRides,\n\t\tTSS = Real2,\n\t\tATL,\n\t\tCTL,\n\t\tTSB\n\t)) ~> CTLTable\nDerivedColumn1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false) ~> sink1"
		}
	}
}